{% load static %}
<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="utf-8">
  <title>{{ home_data.site_name }}</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- BOOTSTRAP -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <style>
    body { background-color: #f5f5f5; }
    .navbar-brand img { height: 32px; object-fit: contain; }
    .carousel-item img { max-height: 400px; object-fit: cover; }
    .carousel-caption { background: rgba(0,0,0,0.45); border-radius: 8px; padding: 20px; }
    .product-card img { height: 200px; object-fit: contain; }
    .product-card { transition: transform .2s, box-shadow .2s; }
    .product-card:hover { transform: translateY(-5px); box-shadow: 0 10px 20px rgba(0,0,0,.15); }
    .flash-bar { background: #e63946; color: white; font-weight: bold; }
    .sidebar { background: #fff; border-radius: 8px; padding: 10px 0; }
    .sidebar ul li { font-size: 14px; padding: 10px 15px; cursor: pointer; border-bottom: 1px solid #f1f1f1; }
    .sidebar ul li:hover { background: #f68b1e; color: #fff; }

    .carousel-item img {
  height: 420px;
  object-fit: cover;
}

.carousel-fade .carousel-item {
  transition: opacity 1s ease-in-out;
}

.custom-caption {
  background: rgba(0, 0, 0, 0.55);
  padding: 30px;
  border-radius: 12px;
  bottom: 20%;
  max-width: 70%;
  margin: auto;
}

.custom-caption h2 {
  font-size: 28px;
}

.custom-caption p {
  font-size: 16px;
}

@media (max-width: 768px) {
  .carousel-item img {
    width: 100%;
    height: 500px;
    object-fit: cover;
  }

  .custom-caption {
    bottom: 10%;
    padding: 15px;
    max-width: 90%;
  }

  .custom-caption h2 {
    font-size: 18px;
  }

  .custom-caption p {
    font-size: 14px;
  }
}
  </style>
</head>

<body>

<nav class="navbar navbar-dark bg-dark shadow-sm">
  <div class="container d-flex align-items-center">

    <a class="navbar-brand d-flex align-items-center" href="#">
      {% if home_data.logo %}
      <img src="{{ home_data.logo.url }}" alt="logo">
      {% endif %}
      <strong class="ms-2">{{ home_data.site_name }}</strong>
    </a>

    <!-- üîç BARRE DE RECHERCHE -->
    <form method="GET" action="{% url 'home' %}" class="d-flex ms-3 flex-grow-1">
      <input
        class="form-control me-2"
        type="search"
        name="q"
        placeholder="Rechercher un produit..."
        value="{{ query }}"
      >
      <button class="btn btn-warning fw-bold" type="submit">
        Rechercher
      </button>
    </form>

  </div>
</nav>

<div class="container-fluid px-0 mt-3">
  <div class="row g-0">

    <!-- ===== CAROUSEL ===== -->
    <!-- <section class="col-md-7">
      <div id="homeCarousel" class="carousel slide shadow-sm rounded" data-bs-ride="carousel">
        <div class="carousel-inner">

          {% for slide in slides %}
          <div class="carousel-item {% if forloop.first %}active{% endif %}">

            {% if slide.image %}
            <img src="{{ slide.image.url }}" class="d-block w-100" {% if not forloop.first %}loading="lazy"{% endif %}>
            {% else %}
            <img src="{% static 'default_slide.jpg' %}" class="d-block w-100">
            {% endif %}

            <div class="carousel-caption d-none d-md-block">
              <h3>{{ slide.title }}</h3>
              <p>{{ slide.message|safe }}</p>
              {% if slide.action_text %}
              <a href="{{ slide.action_link }}" class="btn btn-warning fw-bold">
                {{ slide.action_text }}
              </a>
              {% endif %}
            </div>

          </div>
          {% endfor %}

        </div>
      </div>
    </section> -->
    <section class="col-12 px-0">

      <div id="homeCarousel"
           class="carousel slide carousel-fade shadow-sm"
           data-bs-ride="carousel"
           data-bs-interval="4000">
    
        <!-- INDICATEURS -->
        <div class="carousel-indicators">
          {% for slide in slides %}
          <button type="button"
                  data-bs-target="#homeCarousel"
                  data-bs-slide-to="{{ forloop.counter0 }}"
                  class="{% if forloop.first %}active{% endif %}">
          </button>
          {% endfor %}
        </div>
    
        <div class="carousel-inner">
    
          {% for slide in slides %}
          <div class="carousel-item {% if forloop.first %}active{% endif %}">
    
            {% if slide.image %}
            <img src="{{ slide.image.url }}"
                 class="d-block w-100"
                 alt="{{ slide.title }}"
                 {% if not forloop.first %}loading="lazy"{% endif %}>
            {% else %}
            <img src="{% static 'default_slide.jpg' %}"
                 class="d-block w-100">
            {% endif %}
    
            <!-- CAPTION AM√âLIOR√â -->
            <div class="carousel-caption custom-caption">
              <h2 class="fw-bold">{{ slide.title }}</h2>
              <p class="lead">{{ slide.message|safe }}</p>
    
              {% if slide.action_text %}
              <a href="{{ slide.action_link }}"
                 class="btn btn-warning btn-lg fw-bold mt-2">
                {{ slide.action_text }}
              </a>
              {% endif %}
            </div>
    
          </div>
          {% endfor %}
    
        </div>
    
        <!-- BOUTONS NAVIGATION -->
        <button class="carousel-control-prev"
                type="button"
                data-bs-target="#homeCarousel"
                data-bs-slide="prev">
          <span class="carousel-control-prev-icon"></span>
        </button>
    
        <button class="carousel-control-next"
                type="button"
                data-bs-target="#homeCarousel"
                data-bs-slide="next">
          <span class="carousel-control-next-icon"></span>
        </button>
    
      </div>
    
    </section>
    <!-- ===== ASSISTANCE ===== -->
    <!-- <aside class="col-md-3 d-none d-md-block">
      <div class="bg-white shadow-sm rounded p-3">
        <h6>üìû Centre d‚Äôassistance</h6>
        <p class="small">Service client 24/7</p>
        <strong class="text-danger">2520 006 161</strong>
        <div class="bg-white shadow-sm rounded p-3 text-ceanter mt-3">
          <h6>üì± Scanner pour acc√©der</h6>
          <img src="data:image/png;base64,{{ qr_code }}"
               alt="QR Code"
               class="img-fluid"
               style="max-width:150px;">
          <p class="small mt-2">Scannez pour ouvrir la boutique</p>
        </div>
        
      
      </div>
    </aside> -->

  </div>
</div>

<!-- ================= FLASH SALES ================= -->
<div class="container mt-4">
  <div class="flash-bar p-2 rounded d-flex justify-content-between">
    <span>‚ö° Ventes Flash | Chaque jour</span>
    <span>‚è±Ô∏è Offre limit√©e</span>
  </div>
</div>

<!-- ================= PRODUCTS ================= -->
<div class="container py-4">
  <div class="row g-3">

    {% for product in products %}
    <div class="col-6 col-md-3">
      <div class="card product-card h-100">

        {% if product.image %}
        <img src="{{ product.image.url }}" class="card-img-top" loading="lazy">
        {% endif %}

        <div class="card-body d-flex flex-column">
          <h6>{{ product.name }}</h6>
          <strong class="text-danger mb-2">{{ product.price }} FCFA</strong>

          <!-- <div class="mt-auto">
          <!-- <div class="mt-auto">
            {% if product.quantity > 0 %}
            <span class="badge bg-success">En stock</span>
            <a href="{% url 'commande' product.id %}" class="btn btn-sm btn-warning w-100 mt-2">
              Commander
            </a>
            {% else %}
            <span class="badge bg-danger">Rupture de stock</span>
            <button class="btn btn-sm btn-secondary w-100 mt-2" disabled>
              Rupture de stock
            </button>
            {% endif %}
          </div> -->
<div class="mt-auto">

  <!-- üîç Bouton D√âTAILS -->
  <a href="{% url 'product_detail' product.id %}"
     class="btn btn-sm btn-outline-primary w-100 mb-2">
    üëÅÔ∏è Voir d√©tails
  </a>

  {% if product.quantity > 0 %}
  <span class="badge bg-success">En stock</span>
  <a href="{% url 'commande' product.id %}"
     class="btn btn-sm btn-warning w-100 mt-2">
    Commander
  </a>
  {% else %}
  <span class="badge bg-danger">Rupture de stock</span>
  <button class="btn btn-sm btn-secondary w-100 mt-2" disabled>
    Rupture de stock
  </button>
  {% endif %}

</div>

        </div>
      </div>
    </div>
    {% endfor %}

  </div>
</div>
<!-- ================= FOOTER ================= -->
<footer class="bg-dark text-white py-4">
  <div class="container text-center">
    <p>{{ home_data.footer_message|safe }}</p>
    {% if home_data.logo %}
    <img src="{{ home_data.logo.url }}" height="32">
    {% endif %}
  </div>
</footer>

</body>
</html>
